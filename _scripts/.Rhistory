fqTable2 <- fqTable2 %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(aprendizaje))
fqTable2$Categoria <- factor(fqTable2$Categoria, levels = c("Totalmente en desacuerdo",
"En desacuerdo",
"Ni de acuerdo ni en desacuerdo",
"De acuerdo",
"Totalmente de acuerdo"), ordered = T)
# Plot it (SAVE IT!!!!)
# x11()
gg <- fqTable2 %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Porcentaje (%)") +
coord_flip() +
xlim(0, 1) +
facet_wrap(~ Variable) +
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
ggsave("../_results/_descriptive_analysis/frecuencias_tecnologia.png", plot = gg, width = 22, height = 10, units = "in"); rm(fqTable2, gg)
fqTable2 <- tecnologia %>%
gather(measure, value) %>%
count(measure, value)
names(fqTable2) <- c("Variable", "Categoria", "Frecuencia")
fqTable2 <- fqTable2 %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(aprendizaje))
fqTable2$Categoria <- factor(fqTable2$Categoria, levels = c("Totalmente en desacuerdo",
"En desacuerdo",
"Ni de acuerdo ni en desacuerdo",
"De acuerdo",
"Totalmente de acuerdo"), ordered = T)
# Plot it (SAVE IT!!!!)
# x11()
gg <- fqTable2 %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Porcentaje (%)") +
coord_flip() +
scale_y_continuous(limits = c(0, 1)) +
facet_wrap(~ Variable) +
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
ggsave("../_results/_descriptive_analysis/frecuencias_tecnologia.png", plot = gg, width = 22, height = 10, units = "in"); rm(fqTable2, gg)
fqTable2 <- tecnologia %>%
gather(measure, value) %>%
count(measure, value)
names(fqTable2) <- c("Variable", "Categoria", "Frecuencia")
fqTable2 <- fqTable2 %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(aprendizaje))
fqTable2$Categoria <- factor(fqTable2$Categoria, levels = c("Totalmente en desacuerdo",
"En desacuerdo",
"Ni de acuerdo ni en desacuerdo",
"De acuerdo",
"Totalmente de acuerdo"), ordered = T)
# Plot it (SAVE IT!!!!)
# x11()
gg <- fqTable2 %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Porcentaje (%)") +
coord_flip() +
scale_y_continuous(limits = c(0, 100)) +
facet_wrap(~ Variable) +
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
ggsave("../_results/_descriptive_analysis/frecuencias_tecnologia.png", plot = gg, width = 22, height = 10, units = "in"); rm(fqTable2, gg)
fqTable <- aprendizaje %>%
gather(measure, value) %>%
count(measure, value)
names(fqTable) <- c("Variable", "Categoria", "Frecuencia")
fqTable <- fqTable %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(aprendizaje))
fqTable$Categoria <- factor(fqTable$Categoria, levels = c("Totalmente en desacuerdo",
"En desacuerdo",
"Ni de acuerdo ni en desacuerdo",
"De acuerdo",
"Totalmente de acuerdo"), ordered = T)
# Plot it (SAVE IT!!!!)
# x11()
gg <- fqTable %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Porcentaje (%)") +
coord_flip() +
scale_y_continuous(limits = c(0, 100))
facet_wrap(~ Variable) + # , scales = "free"
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
ggsave("../_results/_descriptive_analysis/frecuencias_aprendizaje.png", plot = gg, width = 22, height = 10, units = "in"); rm(fqTable, gg)
aprendizaje <- pilares %>% dplyr::select(P5_4, P5_5, P6_1, P6_2, P6_5, P7_2, P8_1, P13_13:P13_16)
aprendizaje %>% glimpse
# Analisis descriptivo
fqTable <- aprendizaje %>%
gather(measure, value) %>%
count(measure, value)
names(fqTable) <- c("Variable", "Categoria", "Frecuencia")
fqTable <- fqTable %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(aprendizaje))
fqTable$Categoria <- factor(fqTable$Categoria, levels = c("Totalmente en desacuerdo",
"En desacuerdo",
"Ni de acuerdo ni en desacuerdo",
"De acuerdo",
"Totalmente de acuerdo"), ordered = T)
# Plot it (SAVE IT!!!!)
# x11()
gg <- fqTable %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Porcentaje (%)") +
coord_flip() +
scale_y_continuous(limits = c(0, 100)) +
facet_wrap(~ Variable) + # , scales = "free"
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
ggsave("../_results/_descriptive_analysis/frecuencias_aprendizaje.png", plot = gg, width = 22, height = 10, units = "in"); rm(fqTable, gg)
liderazgo <- pilares %>% dplyr::select(P3_1:P3_3, P3_5:P3_8, P8_3, P8_4, P8_5, P13_1, P13_2, P13_3, P13_4)
liderazgo  %>% glimpse
# Analisis descriptivo
fqTable3 <- liderazgo  %>%
gather(measure, value) %>%
count(measure, value)
names(fqTable3) <- c("Variable", "Categoria", "Frecuencia")
fqTable3 <- fqTable3 %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(liderazgo))
fqTable3$Categoria <- factor(fqTable3$Categoria, levels = c("Totalmente en desacuerdo",
"En desacuerdo",
"Ni de acuerdo ni en desacuerdo",
"De acuerdo",
"Totalmente de acuerdo"), ordered = T)
# Plot it (SAVE IT!!!!)
# x11()
gg <- fqTable3 %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Porcentaje (%)") +
coord_flip() +
scale_y_continuous(limits = c(0, 100)) +
facet_wrap(~ Variable, scales = "free") +
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
ggsave("../_results/_descriptive_analysis/frecuencias_liderazgo.png", plot = gg, width = 22, height = 10, units = "in"); rm(fqTable3, gg)
organizacion <- pilares %>% dplyr::select(P5_1:P5_3, P6_3, P6_4, P7_1, P7_3, P8_2, P13_9, P13_11)
organizacion  %>% glimpse
# Analisis descriptivo
fqTable4 <- organizacion  %>%
gather(measure, value) %>%
count(measure, value)
names(fqTable4) <- c("Variable", "Categoria", "Frecuencia")
fqTable4 <- fqTable4 %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(organizacion))
fqTable4$Categoria <- factor(fqTable4$Categoria, levels = c("Totalmente en desacuerdo",
"En desacuerdo",
"Ni de acuerdo ni en desacuerdo",
"De acuerdo",
"Totalmente de acuerdo"), ordered = T)
# Plot it (SAVE IT!!!!)
# x11()
gg <- fqTable4 %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Porcentaje (%)") +
coord_flip() +
scale_y_continuous(limits = c(0, 100)) +
facet_wrap(~ Variable, scales = "free") +
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
ggsave("../_results/_descriptive_analysis/frecuencias_organizacion.png", plot = gg, width = 22, height = 10, units = "in"); rm(fqTable4, gg)
fqTable3 <- liderazgo  %>%
gather(measure, value) %>%
count(measure, value)
names(fqTable3) <- c("Variable", "Categoria", "Frecuencia")
fqTable3 <- fqTable3 %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(liderazgo))
fqTable3$Categoria <- factor(fqTable3$Categoria, levels = c("Totalmente en desacuerdo",
"En desacuerdo",
"Ni de acuerdo ni en desacuerdo",
"De acuerdo",
"Totalmente de acuerdo"), ordered = T)
# Plot it (SAVE IT!!!!)
# x11()
gg <- fqTable3 %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Porcentaje (%)") +
coord_flip() +
scale_y_continuous(limits = c(0, 100)) +
facet_wrap(~ Variable) +
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
ggsave("../_results/_descriptive_analysis/frecuencias_liderazgo.png", plot = gg, width = 22, height = 10, units = "in"); rm(fqTable3, gg)
fqTable4 <- organizacion  %>%
gather(measure, value) %>%
count(measure, value)
names(fqTable4) <- c("Variable", "Categoria", "Frecuencia")
fqTable4 <- fqTable4 %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(organizacion))
fqTable4$Categoria <- factor(fqTable4$Categoria, levels = c("Totalmente en desacuerdo",
"En desacuerdo",
"Ni de acuerdo ni en desacuerdo",
"De acuerdo",
"Totalmente de acuerdo"), ordered = T)
# Plot it (SAVE IT!!!!)
# x11()
gg <- fqTable4 %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Porcentaje (%)") +
coord_flip() +
scale_y_continuous(limits = c(0, 100)) +
facet_wrap(~ Variable) +
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
ggsave("../_results/_descriptive_analysis/frecuencias_organizacion.png", plot = gg, width = 22, height = 10, units = "in"); rm(fqTable4, gg)
aprendizaje <- pilares %>% dplyr::select(P5_4, P5_5, P6_1, P6_2, P6_5, P7_2, P8_1, P13_13:P13_16)
aprendizaje %>% glimpse
# Analisis descriptivo
fqTable <- aprendizaje %>%
gather(measure, value) %>%
count(measure, value)
names(fqTable) <- c("Variable", "Categoria", "Frecuencia")
fqTable <- fqTable %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(aprendizaje
paste0("P13_", 13:16)
paste0("P13_", 13:16)
aprendizaje <- pilares %>% dplyr::select(P5_4, P5_5, P6_1, P6_2, P6_5, P7_2, P8_1, P13_13:P13_16)
aprendizaje %>% glimpse
# Analisis descriptivo
fqTable <- aprendizaje %>%
gather(measure, value) %>%
count(measure, value)
names(fqTable) <- c("Variable", "Categoria", "Frecuencia")
fqTable <- fqTable %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(aprendizaje))
fqTable$Categoria <- factor(fqTable$Categoria, levels = c("Totalmente en desacuerdo",
"En desacuerdo",
"Ni de acuerdo ni en desacuerdo",
"De acuerdo",
"Totalmente de acuerdo"), ordered = T)
fqTable$Variable <- factor(fqTable$Variable, levels = c("P5_4", "P5_5", "P6_1",
"P6_2", "P6_5", "P7_2",
"P8_1", paste0("P13_", 13:16)),
ordered = T)
gg <- fqTable %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Porcentaje (%)") +
coord_flip() +
scale_y_continuous(limits = c(0, 100)) +
facet_wrap(~ Variable) + # , scales = "free"
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
ggsave("../_results/_descriptive_analysis/frecuencias_aprendizaje.png", plot = gg, width = 22, height = 10, units = "in"); rm(fqTable, gg)
paste0("P11_", 1:5)
fqTable2 <- tecnologia %>%
gather(measure, value) %>%
count(measure, value)
names(fqTable2) <- c("Variable", "Categoria", "Frecuencia")
fqTable2 <- fqTable2 %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(aprendizaje))
fqTable2$Categoria <- factor(fqTable2$Categoria, levels = c("Totalmente en desacuerdo",
"En desacuerdo",
"Ni de acuerdo ni en desacuerdo",
"De acuerdo",
"Totalmente de acuerdo"), ordered = T)
fqTable2$Variable <- factor(fqTable2$Variable, levels = c("P3_4", "P5_6", "P7_4", "P7_5",
paste0("P11_", 1:5),
"P13_5", "P13_6", "P13_7", "P13_8"),
ordered = T)
# Plot it (SAVE IT!!!!)
# x11()
gg <- fqTable2 %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Porcentaje (%)") +
coord_flip() +
scale_y_continuous(limits = c(0, 100)) +
facet_wrap(~ Variable) +
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
ggsave("../_results/_descriptive_analysis/frecuencias_tecnologia.png", plot = gg, width = 22, height = 10, units = "in"); rm(fqTable2, gg)
fqTable3 <- liderazgo  %>%
gather(measure, value) %>%
count(measure, value)
names(fqTable3) <- c("Variable", "Categoria", "Frecuencia")
fqTable3 <- fqTable3 %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(liderazgo))
fqTable3$Categoria <- factor(fqTable3$Categoria, levels = c("Totalmente en desacuerdo",
"En desacuerdo",
"Ni de acuerdo ni en desacuerdo",
"De acuerdo",
"Totalmente de acuerdo"), ordered = T)
fqTable3$Variable <- factor(fqTable3$Variable, levels = c(paste0("P3_", 1:3), paste0("P3_", 5:8),
"P8_3", "P8_4", "P8_5", "P13_1", "P13_2",
"P13_3", "P13_4"),
ordered = T)
# Plot it (SAVE IT!!!!)
# x11()
gg <- fqTable3 %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Porcentaje (%)") +
coord_flip() +
scale_y_continuous(limits = c(0, 100)) +
facet_wrap(~ Variable) +
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
ggsave("../_results/_descriptive_analysis/frecuencias_liderazgo.png", plot = gg, width = 22, height = 10, units = "in"); rm(fqTable3, gg)
fqTable4 <- organizacion  %>%
gather(measure, value) %>%
count(measure, value)
names(fqTable4) <- c("Variable", "Categoria", "Frecuencia")
fqTable4 <- fqTable4 %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(organizacion))
fqTable4$Categoria <- factor(fqTable4$Categoria, levels = c("Totalmente en desacuerdo",
"En desacuerdo",
"Ni de acuerdo ni en desacuerdo",
"De acuerdo",
"Totalmente de acuerdo"), ordered = T)
fqTable4$Variable <- factor(fqTable4$Variable, levels = c(paste0("P5_", 1:3), "P6_3", "P6_4",
"P7_1", "P7_3", "P8_2", "P13_9", "P13_11"),
ordered = T)
# Plot it (SAVE IT!!!!)
# x11()
gg <- fqTable4 %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Porcentaje (%)") +
coord_flip() +
scale_y_continuous(limits = c(0, 100)) +
facet_wrap(~ Variable) +
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
ggsave("../_results/_descriptive_analysis/frecuencias_organizacion.png", plot = gg, width = 22, height = 10, units = "in"); rm(fqTable4, gg)
suppressMessages(library(GGally))
suppressMessages(library(CCA))
km_data <- read.spss(file = "../_data/Base GConocimiento PymeS  Valle_2017.sav", to.data.frame = T, use.value.labels = F) # F
aprendizaje <- km_data %>% dplyr::select(P5_4, P5_5, P6_1, P6_2, P6_5, P7_2, P8_1, P13_13:P13_16)
tecnologia <- km_data %>% dplyr::select(P3_4, P5_6, P7_4, P7_5, P11_1:P11_5, P13_5, P13_6, P13_7, P13_8)
# x11()
corrplot(cor(cbind(aprendizaje, tecnologia)), method = "square")
cc1 <- cc(tecnologia, aprendizaje)
cc1$cor[1]
liderazgo <- km_data %>% dplyr::select(P3_1:P3_3, P3_5:P3_8, P8_3, P8_4, P8_5, P13_1, P13_2, P13_3, P13_4)
organizacion <- km_data %>% dplyr::select(P5_1:P5_3, P6_3, P6_4, P7_1, P7_3, P8_2, P13_9, P13_11)
cc1 <- cc(liderazgo, organizacion)
cc1$cor[1]
corrplot(cor(cbind(liderazgo, organizacion)), method = "square")
cc2 <- comput(liderazgo, organizacion, cc1)
cc2[3:6]
install.packages("DescTools")
km_data <- read.spss(file = "../_data/Base GConocimiento PymeS  Valle_2017.sav", to.data.frame = T, use.value.labels = T) # F
names(km_data)
pilares <- km_data %>% select(P3_1:P3_8, P5_1:P9_6, P11_1:P13_16, P22_1:P25_5)
for(j in 1:ncol(pilares)){
pilares[,j] <- factor(pilares[,j], levels = c("Totalmente en desacuerdo",
"En desacuerdo",
"Ni de acuerdo ni en desacuerdo",
"De acuerdo",
"Totalmente de acuerdo"), ordered = T)
}; rm(j)
aprendizaje <- pilares %>% dplyr::select(P5_4, P5_5, P6_1, P6_2, P6_5, P7_2, P8_1, P13_13:P13_16)
suppressMessages(library(DescTools))
DescTools::Entropy(x = aprendizaje$P5_4)
aprendizaje$P5_4
DescTools::Entropy(x = table(aprendizaje$P5_4))
DescTools::Entropy(x = table(aprendizaje$P5_4), base = exp(1))
DescTools::Entropy(x = table(aprendizaje$P5_4), base = exp(1))
table(aprendizaje$P5_4)
sum(table(aprendizaje$P5_4))
sum(table(aprendizaje$P5_4))/5
DescTools::Entropy(x = rep(24.8, 5), base = exp(1))
DescTools::Entropy(x = rep(24.8, 5), base = exp(1))
DescTools::Entropy(x = table(aprendizaje$P5_4), base = exp(1))
DescTools::Entropy(x = table(aprendizaje$P13_16), base = exp(1))
DescTools::Entropy(x = table(aprendizaje$P5_4), base = exp(1))/DescTools::Entropy(x = rep(24.8, 5), base = exp(1))
DescTools::Entropy(x = table(aprendizaje$P13_16), base = exp(1))/DescTools::Entropy(x = rep(24.8, 5), base = exp(1))
DescTools::Entropy(x = table(aprendizaje$P7_2), base = exp(1))/DescTools::Entropy(x = rep(24.8, 5), base = exp(1))
DescTools::Entropy(x = table(aprendizaje$P6_1), base = exp(1))/DescTools::Entropy(x = rep(24.8, 5), base = exp(1))
rep(24.8, 5)
124/5
Mode(x = aprendizaje$P5_4)
DescTools::Mode(x = aprendizaje$P5_4)
name(aprendizaje$P5_4)
names(aprendizaje$P5_4)
cat.metrics <- function(var, var.name){
mode.var <- DescTools::Mode(x = var)
entropy.var <- DescTools::Entropy(x = table(var), base = exp(1))/DescTools::Entropy(x = rep(24.8, 5), base = exp(1))
results <- data.frame(Variable = var.name, Mode = mode.var, Entropy = entropy.var)
return(results)
}
cat.metrics(var = aprendizaje$P5_4, var.name = "P5_4")
names(pilares)
varList <- names(pilares)
paste0('var <- pilares$', varList[1])
varList <- names(pilares)
varMetrics <- lapply(1:ncol(pilares), function(i){
var.name <- varList[i]
eval(parse(text = paste0('var <- pilares$', varList[i])))
return(cat.metrics(var = var, var.name = var.name))
})
varMetrics <- do.call(rbind, varMetrics)
View(varMetrics)
varMetrics %>% ggplot(aes(x = reorder(Variable, Entropy), y = Entropy)) + geom_bar(stat = "identity") +
coord_flip() + theme_bw()
head(varMetrics)
(varMetrics) %>% str
varMetrics %>% ggplot(aes(x = reorder(Variable, Entropy), y = Entropy)) + geom_bar() +
coord_flip() + theme_bw()
varMetrics %>% ggplot(aes(x = reorder(Variable, Entropy), y = Entropy)) + geom_bar(stat = "identity") +
coord_flip() + theme_bw()
hist(varMetrics$Entropy)
max(varMetrics$Entropy)
min(varMetrics$Entropy)
varMetrics %>% ggplot(aes(x = reorder(Variable, Entropy), y = Entropy)) + geom_bar(stat = "identity")
varMetrics %>% ggplot(aes(x = Variable, y = Entropy)) + geom_bar(stat = "identity") +
coord_flip() + theme_bw()
View(varMetrics)
table(varMetrics$Variable)
varList <- unique(names(pilares))
varMetrics <- lapply(1:ncol(pilares), function(i){
var.name <- varList[i]
eval(parse(text = paste0('var <- pilares$', varList[i])))
return(cat.metrics(var = var, var.name = var.name))
})
varMetrics <- do.call(rbind, varMetrics)
varMetrics %>% ggplot(aes(x = Variable, y = Entropy)) + geom_bar(stat = "identity") +
coord_flip() + theme_bw()
varList <- unique(names(pilares))
varList
varList <- pilares %>% names
varList <- pilares %>% names %>% unique
table(varList)
varMetrics <- lapply(1:length(varList), function(i){
var.name <- varList[i]
eval(parse(text = paste0('var <- pilares$', varList[i])))
return(cat.metrics(var = var, var.name = var.name))
})
varMetrics <- do.call(rbind, varMetrics)
unique(varMetrics) %>% dim
varList <- pilares %>% names %>% unique
1:length(varList)
varList[i]
varMetrics <- lapply(1:length(varList), function(i){
var.name <- varList[i]
eval(parse(text = paste0('var <- pilares$', varList[i])))
return(cat.metrics(var = var, var.name = var.name))
})
varMetrics <- do.call(rbind, varMetrics)
varList <- pilares %>% names %>% unique
varMetrics <- lapply(1:length(varList), function(i){
var.name <- varList[i]
eval(parse(text = paste0('var <- pilares$', varList[i])))
return(cat.metrics(var = var, var.name = var.name))
})
varMetrics
varMetrics2 <- do.call(rbind, varMetrics)
View(varMetrics2)
View(varMetrics2)
DescTools::Mode(x = pilares$P12_1)
cat.metrics <- function(var, var.name){
mode.var <- DescTools::Mode(x = var)[1]
entropy.var <- DescTools::Entropy(x = table(var), base = exp(1))/DescTools::Entropy(x = rep(24.8, 5), base = exp(1))
results <- data.frame(Variable = var.name, Mode = mode.var, Entropy = entropy.var)
return(results)
}
varList <- pilares %>% names %>% unique
varMetrics <- lapply(1:length(varList), function(i){
var.name <- varList[i]
eval(parse(text = paste0('var <- pilares$', varList[i])))
return(cat.metrics(var = var, var.name = var.name))
})
varMetrics <- do.call(rbind, varMetrics)
varMetrics %>% ggplot(aes(x = reorder(Variable, Entropy), y = Entropy)) + geom_bar(stat = "identity") +
coord_flip() + theme_bw()
reorder(Variable, Entropy)
varMetrics
varMetrics <- do.call(rbind, varMetrics)
varMetrics %>% ggplot(aes(x = reorder(Variable, Entropy), y = Entropy)) + geom_bar(stat = "identity")
varMetrics %>% ggplot(aes(x = reorder(Variable, Entropy), y = Entropy)) + geom_bar(stat = "identity")
varList <- pilares %>% names %>% unique
varMetrics <- lapply(1:length(varList), function(i){
var.name <- varList[i]
eval(parse(text = paste0('var <- pilares$', varList[i])))
return(cat.metrics(var = var, var.name = var.name))
})
varMetrics <- do.call(rbind, varMetrics)
varMetrics %>% ggplot(aes(x = reorder(Variable, Entropy), y = Entropy)) + geom_bar(stat = "identity") +
coord_flip() + theme_bw()
varMetrics %>% ggplot(aes(x = reorder(Variable, Entropy), y = Entropy)) + geom_bar()
??geom_bar
varMetrics %>% ggplot(aes(x = reorder(Variable, Entropy), y = Entropy)) + geom_bar(stat = "fill") +
coord_flip() + theme_bw()
varMetrics %>% ggplot(aes(x = reorder(Variable, -Entropy), y = Entropy, fill = Variable)) + geom_bar(stat = "identity") +
coord_flip() + theme_bw()
varMetrics %>% ggplot(aes(x = reorder(Variable, -Entropy), y = Entropy)) + geom_bar(stat = "identity") +
coord_flip() + theme_bw()
?reorder
varMetrics %>% ggplot(aes(x = reorder(Variable, -Entropy), y = Entropy)) + geom_bar(stat = "identity") +
coord_flip() + theme_bw()
varMetrics %>% ggplot(aes(x = reorder(Variable, -Entropy), y = Entropy)) + geom_bar(stat = "identity", position="dodge") +
coord_flip() + theme_bw()
