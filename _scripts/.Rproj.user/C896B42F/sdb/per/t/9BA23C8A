{
    "collab_server" : "",
    "contents" : "# Gestion del conocimiento - Proyecto Univalle: cargar y explorar datos\n# H. Achicanoy & C. Saavedra\n# 2017\n\n# R options\noptions(warn = -1); options(scipen = 999)\n\n# Load packages\nsuppressMessages(library(tidyverse))\nsuppressMessages(library(modelr))\nsuppressMessages(library(dplyr))\nsuppressMessages(library(purrr))\nsuppressMessages(library(broom))\nsuppressMessages(library(tidyr))\nsuppressMessages(library(ggplot2))\nsuppressMessages(library(FactoMineR))\nsuppressMessages(library(factoextra))\nsuppressMessages(library(foreign))\nsuppressMessages(library(haven))\nsuppressMessages(library(corrplot))\nsuppressMessages(library(polycor))\nsuppressMessages(library(psych))\nsuppressMessages(library(gplots))\nsuppressMessages(library(viridis))\nsuppressMessages(library(lsr))\nsuppressMessages(library(DescTools))\n\n# ------------------------------------------------------- #\n# Loading data\n# ------------------------------------------------------- #\nkm_data <- read.spss(file = \"../_data/Base GConocimiento PymeS  Valle_2017.sav\", to.data.frame = T, use.value.labels = T) # F\nnames(km_data)\n\npilares <- km_data %>% select(P3_1:P3_8, P5_1:P9_6, P11_1:P13_16, P22_1:P25_5)\nfor(j in 1:ncol(pilares)){\n  pilares[,j] <- factor(pilares[,j], levels = c(\"Totalmente en desacuerdo\",\n                                                \"En desacuerdo\",\n                                                \"Ni de acuerdo ni en desacuerdo\",\n                                                \"De acuerdo\",\n                                                \"Totalmente de acuerdo\"), ordered = T)\n}; rm(j)\npilares %>% glimpse\npilares %>% str\n\n# ------------------------------------------------------- #\n# Pilar aprendizaje\n# ------------------------------------------------------- #\naprendizaje <- pilares %>% dplyr::select(P5_4, P5_5, P6_1, P6_2, P6_5, P7_2, P8_1, P13_13:P13_16)\naprendizaje %>% glimpse\n\ncat.metrics <- function(var, var.name){\n  mode.var <- DescTools::Mode(x = var)[1]\n  entropy.var <- DescTools::Entropy(x = table(var), base = exp(1))/DescTools::Entropy(x = rep(24.8, 5), base = exp(1))\n  results <- data.frame(Variable = var.name, Mode = mode.var, Entropy = entropy.var)\n  return(results)\n}\n\nvarList <- pilares %>% names %>% unique\nvarMetrics <- lapply(1:length(varList), function(i){\n  var.name <- varList[i]\n  eval(parse(text = paste0('var <- pilares$', varList[i])))\n  return(cat.metrics(var = var, var.name = var.name))\n})\nvarMetrics <- do.call(rbind, varMetrics)\nvarMetrics %>% ggplot(aes(x = reorder(Variable, -Entropy), y = Entropy)) + geom_bar(stat = \"identity\") +\n  coord_flip() + theme_bw()\n\nhist(varMetrics$Entropy)\n\n\n# Entropy\nDescTools::Entropy(x = table(aprendizaje$P5_4), base = exp(1))/DescTools::Entropy(x = rep(24.8, 5), base = exp(1))\nDescTools::Entropy(x = table(aprendizaje$P13_16), base = exp(1))/DescTools::Entropy(x = rep(24.8, 5), base = exp(1))\nDescTools::Entropy(x = table(aprendizaje$P7_2), base = exp(1))/DescTools::Entropy(x = rep(24.8, 5), base = exp(1))\nDescTools::Entropy(x = table(aprendizaje$P6_1), base = exp(1))/DescTools::Entropy(x = rep(24.8, 5), base = exp(1))\n\n# Analisis descriptivo\nfqTable <- aprendizaje %>%\n  gather(measure, value) %>%\n  count(measure, value)\nnames(fqTable) <- c(\"Variable\", \"Categoria\", \"Frecuencia\")\nfqTable <- fqTable %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(aprendizaje))\nfqTable$Categoria <- factor(fqTable$Categoria, levels = c(\"Totalmente en desacuerdo\",\n                               \"En desacuerdo\",\n                               \"Ni de acuerdo ni en desacuerdo\",\n                               \"De acuerdo\",\n                               \"Totalmente de acuerdo\"), ordered = T)\nfqTable$Variable <- factor(fqTable$Variable, levels = c(\"P5_4\", \"P5_5\", \"P6_1\",\n                                                        \"P6_2\", \"P6_5\", \"P7_2\",\n                                                        \"P8_1\", paste0(\"P13_\", 13:16)),\n                           ordered = T)\n\n# Plot it (SAVE IT!!!!)\n# x11()\ngg <- fqTable %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +\n  geom_bar(stat = \"identity\") +\n  xlab(\"\") + ylab(\"Porcentaje (%)\") +\n  coord_flip() +\n  scale_y_continuous(limits = c(0, 100)) +\n  facet_wrap(~ Variable) + # , scales = \"free\"\n  theme_bw() +\n  theme(strip.text = element_text(size = 12, face = \"bold\")) +\n  theme(axis.title.x = element_text(size = 13, face = 'bold'),\n        axis.title.y = element_text(size = 13, face = 'bold'),\n        axis.text = element_text(size = 12))\nggsave(\"../_results/_descriptive_analysis/frecuencias_aprendizaje.png\", plot = gg, width = 22, height = 10, units = \"in\"); rm(fqTable, gg)\n\n# Chi-square test\noptions(warn=-1)\np.chisq = matrix(0, nrow=ncol(aprendizaje), ncol=ncol(aprendizaje), byrow=T)\nfor(i in 1:ncol(aprendizaje)){\n  for(j in 1:ncol(aprendizaje)){\n    p.chisq[i,j] = round(chisq.test(aprendizaje[,i],aprendizaje[,j])$p.value,3)\n  }\n}; rm(i); rm(j)\n\ndiag(p.chisq) = NA\ncolnames(p.chisq) = colnames(aprendizaje)\nrownames(p.chisq) = colnames(aprendizaje)\n\ncolor_scale = colorRampPalette(c(\"tomato3\",\"lightyellow\",\"lightseagreen\"), space=\"rgb\")(50)\npng('../_results/_descriptive_analysis/chi_square_test_aprendizaje.png', height = 7, width = 7, units = \"in\", res = 300)\nheatmap.2(p.chisq,\n          main=\"Aprendizaje\",\n          key.title=\"Chi-square test\",\n          key.xlab=\"p-value\",\n          Rowv=F,\n          Colv=NULL,\n          col=color_scale,\n          linecol=NULL,\n          tracecol=NULL,\n          density.info=\"density\",\n          denscol=\"blue\",\n          margins=c(11,11))\ndev.off()#; rm(catVar, p.chisq, color_scale)\n\n# Cramer's V test\noptions(warn=-1)\np.cramer = matrix(0, nrow=ncol(aprendizaje), ncol=ncol(aprendizaje), byrow=T)\nfor(i in 1:ncol(aprendizaje)){\n  for(j in 1:ncol(aprendizaje)){\n    p.cramer[i,j] = round(lsr::cramersV(aprendizaje[,i],aprendizaje[,j]),3)\n  }\n}; rm(i); rm(j)\n\n# diag(p.cramer) = NA\ncolnames(p.cramer) = colnames(aprendizaje)\nrownames(p.cramer) = colnames(aprendizaje)\n\nx11()\npng(file = '../_results/_descriptive_analysis/cramer_v_test_aprendizaje.png', height = 7, width = 7, units = \"in\", res = 300)\ncorrplot::corrplot(corr = p.cramer, method = \"square\")\ndev.off()\n\n# ------------------------------------------------------- #\n# Pilar Tecnologia \n# ------------------------------------------------------- #\ntecnologia <- pilares %>% dplyr::select(P3_4, P5_6, P7_4, P7_5, P11_1:P11_5, P13_5, P13_6, P13_7, P13_8)\ntecnologia %>% glimpse\n\n# Analisis descriptivo\nfqTable2 <- tecnologia %>%\n  gather(measure, value) %>%\n  count(measure, value)\nnames(fqTable2) <- c(\"Variable\", \"Categoria\", \"Frecuencia\")\nfqTable2 <- fqTable2 %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(aprendizaje))\nfqTable2$Categoria <- factor(fqTable2$Categoria, levels = c(\"Totalmente en desacuerdo\",\n                                                          \"En desacuerdo\",\n                                                          \"Ni de acuerdo ni en desacuerdo\",\n                                                          \"De acuerdo\",\n                                                          \"Totalmente de acuerdo\"), ordered = T)\nfqTable2$Variable <- factor(fqTable2$Variable, levels = c(\"P3_4\", \"P5_6\", \"P7_4\", \"P7_5\",\n                                                          paste0(\"P11_\", 1:5),\n                                                          \"P13_5\", \"P13_6\", \"P13_7\", \"P13_8\"),\n                           ordered = T)\n\n# Plot it (SAVE IT!!!!)\n# x11()\ngg <- fqTable2 %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +\n  geom_bar(stat = \"identity\") +\n  xlab(\"\") + ylab(\"Porcentaje (%)\") +\n  coord_flip() +\n  scale_y_continuous(limits = c(0, 100)) +\n  facet_wrap(~ Variable) +\n  theme_bw() +\n  theme(strip.text = element_text(size = 12, face = \"bold\")) +\n  theme(axis.title.x = element_text(size = 13, face = 'bold'),\n        axis.title.y = element_text(size = 13, face = 'bold'),\n        axis.text = element_text(size = 12))\nggsave(\"../_results/_descriptive_analysis/frecuencias_tecnologia.png\", plot = gg, width = 22, height = 10, units = \"in\"); rm(fqTable2, gg)\n\n\noptions(warn=-1)\np.chisq2 = matrix(0, nrow=ncol(tecnologia), ncol=ncol(tecnologia), byrow=T)\nfor(i in 1:ncol(tecnologia)){\n  for(j in 1:ncol(tecnologia)){\n    p.chisq2[i,j] = round(chisq.test(tecnologia[,i],tecnologia[,j])$p.value,3)\n  }\n}; rm(i); rm(j)\n\ndiag(p.chisq2) = NA\ncolnames(p.chisq2) = colnames(tecnologia)\nrownames(p.chisq2) = colnames(tecnologia)\n\ncolor_scale = colorRampPalette(c(\"tomato3\",\"lightyellow\",\"lightseagreen\"), space=\"rgb\")(50)\npng('../_results/_descriptive_analysis/chi_test_tecnologia.png', height = 7, width = 7, units = \"in\", res = 300)\nheatmap.2(p.chisq2,\n          main=\"Tecnologia\",\n          key.title=\"Chi-square test\",\n          key.xlab=\"p-value\",\n          Rowv=F,\n          Colv=NULL,\n          col=color_scale,\n          linecol=NULL,\n          tracecol=NULL,\n          density.info=\"density\",\n          denscol=\"blue\",\n          margins=c(11,11))\ndev.off()\n\n# Cramer's V test\noptions(warn=-1)\np.cramer2 = matrix(0, nrow=ncol(tecnologia), ncol=ncol(tecnologia), byrow=T)\nfor(i in 1:ncol(tecnologia)){\n  for(j in 1:ncol(tecnologia)){\n    p.cramer2[i,j] = round(lsr::cramersV(tecnologia[,i],tecnologia[,j]),3)\n  }\n}; rm(i); rm(j)\n\n# diag(p.cramer) = NA\ncolnames(p.cramer2) = colnames(tecnologia)\nrownames(p.cramer2) = colnames(tecnologia)\n\nx11()\npng(file = '../_results/_descriptive_analysis/cramer_v_test_tecnologia.png', height = 7, width = 7, units = \"in\", res = 300)\ncorrplot::corrplot(corr = p.cramer2, method = \"square\")\ndev.off()\n\n# ------------------------------------------------------- #\n# Pilar Liderazgo \n# ------------------------------------------------------- #\nliderazgo <- pilares %>% dplyr::select(P3_1:P3_3, P3_5:P3_8, P8_3, P8_4, P8_5, P13_1, P13_2, P13_3, P13_4)\nliderazgo  %>% glimpse\n\n# Analisis descriptivo\nfqTable3 <- liderazgo  %>%\n  gather(measure, value) %>%\n  count(measure, value)\nnames(fqTable3) <- c(\"Variable\", \"Categoria\", \"Frecuencia\")\nfqTable3 <- fqTable3 %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(liderazgo))\nfqTable3$Categoria <- factor(fqTable3$Categoria, levels = c(\"Totalmente en desacuerdo\",\n                                                            \"En desacuerdo\",\n                                                            \"Ni de acuerdo ni en desacuerdo\",\n                                                            \"De acuerdo\",\n                                                            \"Totalmente de acuerdo\"), ordered = T)\nfqTable3$Variable <- factor(fqTable3$Variable, levels = c(paste0(\"P3_\", 1:3), paste0(\"P3_\", 5:8),\n                                                          \"P8_3\", \"P8_4\", \"P8_5\", \"P13_1\", \"P13_2\",\n                                                          \"P13_3\", \"P13_4\"),\n                            ordered = T)\n\n# Plot it (SAVE IT!!!!)\n# x11()\ngg <- fqTable3 %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +\n  geom_bar(stat = \"identity\") +\n  xlab(\"\") + ylab(\"Porcentaje (%)\") +\n  coord_flip() +\n  scale_y_continuous(limits = c(0, 100)) +\n  facet_wrap(~ Variable) +\n  theme_bw() +\n  theme(strip.text = element_text(size = 12, face = \"bold\")) +\n  theme(axis.title.x = element_text(size = 13, face = 'bold'),\n        axis.title.y = element_text(size = 13, face = 'bold'),\n        axis.text = element_text(size = 12))\nggsave(\"../_results/_descriptive_analysis/frecuencias_liderazgo.png\", plot = gg, width = 22, height = 10, units = \"in\"); rm(fqTable3, gg)\n\n\noptions(warn=-1)\np.chisq3 = matrix(0, nrow=ncol(liderazgo), ncol=ncol(liderazgo), byrow=T)\nfor(i in 1:ncol(liderazgo)){\n  for(j in 1:ncol(liderazgo)){\n    p.chisq3[i,j] = round(chisq.test(liderazgo[,i],liderazgo[,j])$p.value,3)\n  }\n}; rm(i); rm(j)\n\ndiag(p.chisq3) = NA\ncolnames(p.chisq3) = colnames(liderazgo)\nrownames(p.chisq3) = colnames(liderazgo)\n\ncolor_scale = colorRampPalette(c(\"tomato3\",\"lightyellow\",\"lightseagreen\"), space=\"rgb\")(50)\npng('../_results/_descriptive_analysis/chi_test_liderazgo.png', height = 7, width = 7, units = \"in\", res = 300)\nheatmap.2(p.chisq3,\n          main=\"Liderazgo\",\n          key.title=\"Chi-square test\",\n          key.xlab=\"p-value\",\n          Rowv=F,\n          Colv=NULL,\n          col=color_scale,\n          linecol=NULL,\n          tracecol=NULL,\n          density.info=\"density\",\n          denscol=\"blue\",\n          margins=c(11,11))\ndev.off()\n\n# Cramer's V test\noptions(warn=-1)\np.cramer3 = matrix(0, nrow=ncol(liderazgo), ncol=ncol(liderazgo), byrow=T)\nfor(i in 1:ncol(liderazgo)){\n  for(j in 1:ncol(liderazgo)){\n    p.cramer3[i,j] = round(lsr::cramersV(liderazgo[,i],liderazgo[,j]),3)\n  }\n}; rm(i); rm(j)\n\n# diag(p.cramer) = NA\ncolnames(p.cramer3) = colnames(liderazgo)\nrownames(p.cramer3) = colnames(liderazgo)\n\nx11()\npng(file = '../_results/_descriptive_analysis/cramer_v_test_liderazgo.png', height = 7, width = 7, units = \"in\", res = 300)\ncorrplot::corrplot(corr = p.cramer3, method = \"square\")\ndev.off()\n\n# ------------------------------------------------------- #\n# Pilar Organizacion \n# ------------------------------------------------------- #\norganizacion <- pilares %>% dplyr::select(P5_1:P5_3, P6_3, P6_4, P7_1, P7_3, P8_2, P13_9, P13_11)\norganizacion  %>% glimpse\n\n# Analisis descriptivo\nfqTable4 <- organizacion  %>%\n  gather(measure, value) %>%\n  count(measure, value)\nnames(fqTable4) <- c(\"Variable\", \"Categoria\", \"Frecuencia\")\nfqTable4 <- fqTable4 %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(organizacion))\nfqTable4$Categoria <- factor(fqTable4$Categoria, levels = c(\"Totalmente en desacuerdo\",\n                                                            \"En desacuerdo\",\n                                                            \"Ni de acuerdo ni en desacuerdo\",\n                                                            \"De acuerdo\",\n                                                            \"Totalmente de acuerdo\"), ordered = T)\nfqTable4$Variable <- factor(fqTable4$Variable, levels = c(paste0(\"P5_\", 1:3), \"P6_3\", \"P6_4\",\n                                                          \"P7_1\", \"P7_3\", \"P8_2\", \"P13_9\", \"P13_11\"),\n                            ordered = T)\n\n# Plot it (SAVE IT!!!!)\n# x11()\ngg <- fqTable4 %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +\n  geom_bar(stat = \"identity\") +\n  xlab(\"\") + ylab(\"Porcentaje (%)\") +\n  coord_flip() +\n  scale_y_continuous(limits = c(0, 100)) +\n  facet_wrap(~ Variable) +\n  theme_bw() +\n  theme(strip.text = element_text(size = 12, face = \"bold\")) +\n  theme(axis.title.x = element_text(size = 13, face = 'bold'),\n        axis.title.y = element_text(size = 13, face = 'bold'),\n        axis.text = element_text(size = 12))\nggsave(\"../_results/_descriptive_analysis/frecuencias_organizacion.png\", plot = gg, width = 22, height = 10, units = \"in\"); rm(fqTable4, gg)\n\n\noptions(warn=-1)\np.chisq4 = matrix(0, nrow=ncol(organizacion), ncol=ncol(organizacion), byrow=T)\nfor(i in 1:ncol(organizacion)){\n  for(j in 1:ncol(organizacion)){\n    p.chisq4[i,j] = round(chisq.test(organizacion[,i],organizacion[,j])$p.value,3)\n  }\n}; rm(i); rm(j)\n\ndiag(p.chisq4) = NA\ncolnames(p.chisq4) = colnames(organizacion)\nrownames(p.chisq4) = colnames(organizacion)\n\ncolor_scale = colorRampPalette(c(\"tomato3\",\"lightyellow\",\"lightseagreen\"), space=\"rgb\")(50)\npng('../_results/_descriptive_analysis/chi_test_organizacion.png', height = 7, width = 7, units = \"in\", res = 300)\nheatmap.2(p.chisq4,\n          main=\"Organizacion\",\n          key.title=\"Chi-square test\",\n          key.xlab=\"p-value\",\n          Rowv=F,\n          Colv=NULL,\n          col=color_scale,\n          linecol=NULL,\n          tracecol=NULL,\n          density.info=\"density\",\n          denscol=\"blue\",\n          margins=c(11,11))\ndev.off()\n\n# Cramer's V test\noptions(warn=-1)\np.cramer4 = matrix(0, nrow=ncol(organizacion), ncol=ncol(organizacion), byrow=T)\nfor(i in 1:ncol(organizacion)){\n  for(j in 1:ncol(organizacion)){\n    p.cramer4[i,j] = round(lsr::cramersV(organizacion[,i],organizacion[,j]),3)\n  }\n}; rm(i); rm(j)\n\n# diag(p.cramer) = NA\ncolnames(p.cramer4) = colnames(organizacion)\nrownames(p.cramer4) = colnames(organizacion)\n\npng(file = '../_results/_descriptive_analysis/cramer_v_test_organizacion.png', height = 7, width = 7, units = \"in\", res = 300)\ncorrplot::corrplot(corr = p.cramer4, method = \"square\")\ndev.off()\n\n#----------------------------------------------------------#\n# Analisis Canonico Tecnologia / Aprendizaje \n#----------------------------------------------------------#\nsuppressMessages(library(GGally))\nsuppressMessages(library(CCA))\n\nkm_data <- read.spss(file = \"../_data/Base GConocimiento PymeS  Valle_2017.sav\", to.data.frame = T, use.value.labels = F) # F\naprendizaje <- km_data %>% dplyr::select(P5_4, P5_5, P6_1, P6_2, P6_5, P7_2, P8_1, P13_13:P13_16)\ntecnologia <- km_data %>% dplyr::select(P3_4, P5_6, P7_4, P7_5, P11_1:P11_5, P13_5, P13_6, P13_7, P13_8)\nliderazgo <- km_data %>% dplyr::select(P3_1:P3_3, P3_5:P3_8, P8_3, P8_4, P8_5, P13_1, P13_2, P13_3, P13_4)\norganizacion <- km_data %>% dplyr::select(P5_1:P5_3, P6_3, P6_4, P7_1, P7_3, P8_2, P13_9, P13_11)\n\n# x11()\ncorrplot(cor(cbind(aprendizaje, tecnologia)), method = \"square\")\ncorrplot(cor(cbind(liderazgo, organizacion)), method = \"square\")\n\n# X: tecnologia\n# Y: aprendizaje\ncc1 <- cc(tecnologia, aprendizaje)\ncc1 <- cc(liderazgo, organizacion)\ncc1$cor[1]\ncc1$cor[1:3]\n\ncc1[3:4]\n\ncc2 <- comput(tecnologia, aprendizaje, cc1)\ncc2 <- comput(liderazgo, organizacion, cc1)\ncc2[3:6]\ncc2[3:6]$corr.X.xscores %>% View\ncc2[3:6]$corr.Y.yscores %>% View\n\nx11()\nggplot(data = data.frame(P7_2 = aprendizaje$P7_2, P7_5 = tecnologia$P7_5), aes(x = P7_2, y = P7_5, size = 28, alpha = .6)) + geom_point()\n\n# Tests of canonical dimensions\nev <- (1 - cc1$cor^2)\n\nn <- dim(aprendizaje)[1]\np <- length(aprendizaje)\nq <- length(tecnologia)\nk <- min(p, q)\nm <- n - 3/2 - (p + q)/2\n\nw <- rev(cumprod(rev(ev)))\n\n# initialize\nd1 <- d2 <- f <- vector(\"numeric\", k)\n\nfor (i in 1:k) {\n  s <- sqrt((p^2 * q^2 - 4)/(p^2 + q^2 - 5))\n  si <- 1/s\n  d1[i] <- p * q\n  d2[i] <- m * s - p * q/2 + 1\n  r <- (1 - w[i]^si)/w[i]^si\n  f[i] <- r * d2[i]/d1[i]\n  p <- p - 1\n  q <- q - 1\n}\n\npv <- pf(f, d1, d2, lower.tail = FALSE)\n(dmat <- cbind(WilksL = w, F = f, df1 = d1, df2 = d2, p = pv))\n\n# standardized psych canonical coefficients diagonal matrix of apre sd's\ns1 <- diag(sqrt(diag(cov(aprendizaje))))\ns1 %*% cc1$xcoef\n# standardized psych canonical coefficients diagonal matrix of tec sd's\ns2 <- diag(sqrt(diag(cov(tecnologia))))\ns2 %*% cc1$ycoef\n\n#----------------------------------------------------------#\n# Alfa de Cronbach \n#----------------------------------------------------------#\n\nsuppressMessages(library(nlme))\nsuppressMessages(library(MASS))\nsuppressMessages(library(multilevel))\n\nkm_data <- read.spss(file = \"../_data/Base GConocimiento PymeS  Valle_2017.sav\", to.data.frame = T, use.value.labels = F)\npilares <- km_data %>% select(P3_1:P3_8, P5_1:P9_6, P11_1:P13_16, P22_1:P25_5)\n\n# Alfa aprendizaje\naprendizaje <- pilares %>% dplyr::select(P5_4, P5_5, P6_1, P6_2, P6_5, P7_2, P8_1, P13_13:P13_16)\nreliability(cov(aprendizaje[,c(\"P5_4\",\"P5_5\",\"P6_1\",\"P6_2\",\"P6_5\",\"P7_2\",\n                               \"P8_1\",\"P13_13\",\"P13_14\",\"P13_15\",\"P13_16\")], use=\"complete.obs\"))\n\n# Alfa tecnologia\ntecnologia <- pilares %>% dplyr::select(P3_4, P5_6, P7_4, P7_5, P11_1:P11_5, P13_5, P13_6, P13_7, P13_8)\nreliability(cov(tecnologia[,c(\"P3_4\", \"P5_6\", \"P7_4\", \"P7_5\", \"P11_1\", \"P11_2\", \"P11_3\", \"P11_4\", \"P11_5\", \"P13_5\", \"P13_6\", \"P13_7\", \"P13_8\")], \n                use=\"complete.obs\"))\n\n#Alfa Liderazgo\nliderazgo <- pilares %>% dplyr::select(P3_1:P3_3, P3_5:P3_8, P8_3, P8_4, P8_5, P13_1, P13_2, P13_3, P13_4)\nreliability(cov(liderazgo[,c(\"P3_1\", \"P3_2\", \"P3_3\", \"P3_5\", \"P3_6\", \"P3_7\", \"P3_8\", \"P8_3\", \"P8_4\", \"P8_5\", \"P13_1\", \"P13_2\", \"P13_3\", \"P13_4\")], \n                use=\"complete.obs\"))\n\n#Alfa Orgamizacion \norganizacion <- pilares %>% dplyr::select(P5_1:P5_3, P6_3, P6_4, P7_1, P7_3, P8_2, P13_9, P13_11)\nreliability(cov(organizacion[,c(\"P5_1\", \"P5_2\", \"P5_3\", \"P6_3\", \"P6_4\", \"P7_1\", \"P7_3\", \"P8_2\", \"P13_9\", \"P13_11\")], \n                use=\"complete.obs\"))\n\n#----------------------------------------------------------#\n# Cuantificacion optima de variables\n#----------------------------------------------------------#\n\nlibrary(homals)\n\n### Aprendizaje\nfaData <- aprendizaje\nfaHomals <- homals(faData, active=rep(TRUE, ncol(faData)), level='ordinal', sets=list(1:ncol(faData)))\nfaQuan   <- faHomals$low.rank # Quantified variables\nfaDataqF <- faData\n\nfor(i in 1:ncol(faDataqF)){\n  \n  faDataqF[,i] <- as.character(faDataqF[,i])\n  dfQuan <- as.data.frame(faQuan[[i]])\n  \n  for(j in 1:length(rownames(dfQuan))){\n    mtch <- which(faDataqF[,i]==rownames(dfQuan)[j])\n    if(length(mtch)>0){\n      faDataqF[,i][which(faDataqF[,i]==rownames(dfQuan)[j])] <- dfQuan[j,1]\n    }\n  }\n  \n  faDataqF[,i] <- as.numeric(faDataqF[,i])\n  \n}; rm(i,j,mtch)\nrm(faData, faHomals, dfQuan, faQuan)\n\nx11()\ncorrplot(cor(cbind(faDataqF)), method = \"number\")\n\n",
    "created" : 1503615934918.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2482022466",
    "id" : "9BA23C8A",
    "lastKnownWriteTime" : 1505001542,
    "last_content_update" : 1505001542424,
    "path" : "D:/ToBackup/repositories/personal/_knowledge_management_project_univalle/_scripts/loading_and_exploring_data.R",
    "project_path" : "loading_and_exploring_data.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}