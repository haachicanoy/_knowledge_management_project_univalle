{
    "collab_server" : "",
    "contents" : "# Gestion del conocimiento - Proyecto Univalle: cargar y explorar datos\n# H. Achicanoy & C. Saavedra\n# 2017\n\n# R options\noptions(warn = -1); options(scipen = 999)\n\n# Load packages\nsuppressMessages(library(tidyverse))\nsuppressMessages(library(modelr))\nsuppressMessages(library(dplyr))\nsuppressMessages(library(purrr))\nsuppressMessages(library(broom))\nsuppressMessages(library(tidyr))\nsuppressMessages(library(ggplot2))\nsuppressMessages(library(FactoMineR))\nsuppressMessages(library(factoextra))\nsuppressMessages(library(foreign))\nsuppressMessages(library(haven))\nsuppressMessages(library(corrplot))\nsuppressMessages(library(polycor))\nsuppressMessages(library(psych))\nsuppressMessages(library(gplots))\nsuppressMessages(library(viridis))\n\n# ------------------------------------------------------- #\n# Loading data\n# ------------------------------------------------------- #\nkm_data <- read.spss(file = \"../_data/Base GConocimiento PymeS  Valle_2017.sav\", to.data.frame = T, use.value.labels = T) # F\nnames(km_data)\n\npilares <- km_data %>% select(P3_1:P3_8, P5_1:P9_6, P11_1:P13_16, P22_1:P25_5)\nfor(j in 1:ncol(pilares)){\n  pilares[,j] <- factor(pilares[,j], levels = c(\"Totalmente en desacuerdo\",\n                                                \"En desacuerdo\",\n                                                \"Ni de acuerdo ni en desacuerdo\",\n                                                \"De acuerdo\",\n                                                \"Totalmente de acuerdo\"), ordered = T)\n}; rm(j)\npilares %>% glimpse\npilares %>% str\n\n# ------------------------------------------------------- #\n# Pilar aprendizaje\n# ------------------------------------------------------- #\naprendizaje <- pilares %>% dplyr::select(P5_4, P5_5, P6_1, P6_2, P6_5, P7_2, P8_1, P13_13:P13_16)\naprendizaje %>% glimpse\n\n# Analisis descriptivo\nfqTable <- aprendizaje %>%\n  gather(measure, value) %>%\n  count(measure, value)\nnames(fqTable) <- c(\"Variable\", \"Categoria\", \"Frecuencia\")\nfqTable <- fqTable %>% dplyr::mutate(Porcentaje = Frecuencia/nrow(fqTable))\nfqTable$Categoria <- factor(fqTable$Categoria, levels = c(\"Totalmente en desacuerdo\",\n                               \"En desacuerdo\",\n                               \"Ni de acuerdo ni en desacuerdo\",\n                               \"De acuerdo\",\n                               \"Totalmente de acuerdo\"), ordered = T)\n\n# Plot it (SAVE IT!!!!)\ngg <- fqTable %>% ggplot(aes(x = Categoria, y = Porcentaje*100)) +\n  geom_bar(stat = \"identity\") +\n  xlab(\"\") + ylab(\"Porcentaje (%)\") +\n  coord_flip() +\n  facet_wrap(~ Variable, scales = \"free\") +\n  theme_bw() +\n  theme(strip.text = element_text(size = 12, face = \"bold\")) +\n  theme(axis.title.x = element_text(size = 13, face = 'bold'),\n        axis.title.y = element_text(size = 13, face = 'bold'),\n        axis.text = element_text(size = 12))\nggsave(\"../_results/_descriptive_analysis/frecuencias_aprendizaje.png\", plot = gg, width = 22, height = 10, units = \"in\"); rm(fqTable, gg)\n\n\noptions(warn=-1)\np.chisq = matrix(0, nrow=ncol(aprendizaje), ncol=ncol(aprendizaje), byrow=T)\nfor(i in 1:ncol(aprendizaje)){\n  for(j in 1:ncol(aprendizaje)){\n    p.chisq[i,j] = round(chisq.test(aprendizaje[,i],aprendizaje[,j])$p.value,3)\n  }\n}; rm(i); rm(j)\n\ndiag(p.chisq) = NA\ncolnames(p.chisq) = colnames(aprendizaje)\nrownames(p.chisq) = colnames(aprendizaje)\n\ncolor_scale = colorRampPalette(c(\"tomato3\",\"lightyellow\",\"lightseagreen\"), space=\"rgb\")(50)\n# png('./_results/chi_test.png', height = 7, width = 7, units = \"in\", res = 300)\nheatmap.2(p.chisq,\n          main=\"Independence test\",\n          key.title=\"Chi-square test\",\n          key.xlab=\"p-value\",\n          Rowv=TRUE,\n          Colv=NULL,\n          col=color_scale,\n          linecol=NULL,\n          tracecol=NULL,\n          density.info=\"density\",\n          denscol=\"blue\",\n          margins=c(11,11))\n# dev.off(); rm(catVar, p.chisq, color_scale)\n\n",
    "created" : 1503615934918.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1340724121",
    "id" : "9BA23C8A",
    "lastKnownWriteTime" : 1503693484,
    "last_content_update" : 1503693484372,
    "path" : "D:/ToBackup/repositories/personal/_knowledge_management_project_univalle/_scripts/loading_and_exploring_data.R",
    "project_path" : "loading_and_exploring_data.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}